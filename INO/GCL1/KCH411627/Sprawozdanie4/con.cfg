# Generated by Anaconda 40.22.3
# Generated by pykickstart v3.52
#version=DEVEL
# Use graphical install
graphical

# Keyboard layouts
keyboard --vckeymap=pl --xlayouts='pl'
# System language
lang pl_PL.UTF-8

# Network information
network  --bootproto=dhcp --device=enp0s3 --ipv6=auto --activate
network  --hostname=fedora-server

# Use network installation
url --mirrorlist="http://mirrors.fedoraproject.org/mirrorlist?repo=fedora-40&arch=x86_64"
repo --name=update --mirrorlist=http://mirrors.fedoraproject.org/mirrorlist?repo=updates-released-f40&arch=x86_64

%packages
@^minimal-environment
java-11-openjdk
wget

%end

# Run the Setup Agent on first boot
firstboot --enable

# Generated using Blivet version 3.9.1
ignoredisk --only-use=sda
autopart
# Partition clearing information
clearpart --all

# System timezone
timezone Europe/Warsaw --utc

#Root password
rootpw --lock
user --groups=wheel --name=fedora --password=$y$j9T$Jxsox5Cpc7rScuW2kFattr9g$zRPq2DZadvm7OivMfpUGpFipzsmq16zs9JFbaCzFSW3 --iscrypted


%post --log=/root/ks-post.log
wget -O /opt/app.jar https://github.com/InzynieriaOprogramowaniaAGH/MDO2024_INO/raw/KCH411627/INO/GCL1/KCH411627/Sprawozdanie4/maven-demo.jar

# Create a systemd service file for the Java application
cat <<EOF > /etc/systemd/system/app.service
[Unit]
Description=Java Application

[Service]
ExecStart=/usr/bin/java -jar /opt/app.jar
SuccessExitStatus=143

[Install]
WantedBy=multi-user.target
EOF

# Reload systemd to apply the new service file
systemctl daemon-reload

# Enable the service to start on boot
systemctl enable app.service

# Start the Java application immediately
systemctl start app.service

%end

reboot