---
- name: Ping my hosts
  ansible.builtin.ping:

- name: Copy file with owner and permissions
  ansible.builtin.copy:
    src: ./inventory.ini
    dest: /home/ansible/inventory.ini
    owner: ansible
    group: ansible
    mode: u=rw,g=r,o=r

- name: Upgrade all packages
  ansible.builtin.dnf:
    name: "*"
    state: latest

- name: Zrestartuj usługę SSH
  ansible.builtin.service:
    name: sshd
    state: restarted

- name: Pobierz Docker
  ansible.builtin.dnf:
    name: docker
    state: latest

- name: Aktywuj docker
  ansible.builtin.service:
    name: docker
    state: started

- name: Pull obrazu take_note_pipeline
  command: docker pull lukaszsawina/take_note_pipeline

- name: Run obrazu take_note_pipeline
  command: docker run -d -p 5000:5000 --name=app lukaszsawina/take_note_pipeline

- name: Stop kontener z take_note_pipeline
  command: docker stop app

- name: Del kontner z take_note_pipeline
  command: docker rm app
